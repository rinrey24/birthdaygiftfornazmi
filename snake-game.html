<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Snake — Classic Nokia Style (No Wall Mode)</title>
  <style>
    :root{--bg:#111;--panel:#0f1720;--accent:#ffcc00;--muted:#cbd5e1}
    html,body{height:100%;margin:0;font-family:Inter,Roboto,Arial,sans-serif;background:linear-gradient(180deg,#061021,#081322);color:var(--muted);display:flex;align-items:center;justify-content:center}
    .wrap{display:grid;grid-template-columns:420px 1fr;gap:20px;align-items:start}
    .card{background:var(--panel);border-radius:12px;padding:16px;box-shadow:0 8px 30px rgba(2,6,23,0.6);}
    canvas{background:#061521;display:block;border-radius:8px;border:2px solid rgba(255,255,255,0.03)}
    h1{margin:0 0 12px 0;font-size:18px;color:var(--accent)}
    p{margin:6px 0;color:var(--muted);font-size:13px}
    .row{display:flex;gap:8px;align-items:center}
    .btn{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:8px 10px;border-radius:8px;color:var(--muted);cursor:pointer}
    .controls{display:flex;gap:6px;flex-wrap:wrap}
    .score{font-weight:700;color:#fff}
    .touch-pad{display:flex;flex-direction:column;gap:6px;align-items:center;user-select:none}
    .touch-row{display:flex;gap:6px}
    .touch-btn{width:56px;height:56px;border-radius:8px;background:rgba(255,255,255,0.03);display:flex;align-items:center;justify-content:center;font-weight:700}
    @media (max-width:900px){.wrap{grid-template-columns:1fr}canvas{width:320px;height:320px}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Snake — Classic Nokia Style</h1>
      <!-- <p>Gunakan tombol panah untuk menggerakkan ular. Spasi untuk pause. Ular mati saat menabrak tubuhnya sendiri.</p> -->
      <div style="display:flex;gap:12px;align-items:center;margin:10px 0">
        <div class="row"><strong>Score:</strong>&nbsp;<span id="score" class="score">0</span></div>
        <button id="restart" class="btn">Restart</button>
        <button id="speedDown" class="btn">- Speed</button>
        <button id="speedUp" class="btn">+ Speed</button>
        <button id="toggleWall" class="btn" style="display: none;">No Wall: OFF</button>
      </div>
      <canvas id="board" width="400" height="400"></canvas>
      
      <p><strong>Keyboard:</strong> Panah ← ↑ → ↓ — Spasi: pause</p>
    </div>

    <!-- <div class="card">
      <h1>Controls & Info</h1>
      <p><strong>Keyboard:</strong> Panah ← ↑ → ↓ — Spasi: pause</p>
      <p><strong>Mobile:</strong> Gunakan tombol di bawah untuk mengontrol.</p>
      <div class="touch-pad" style="margin-top:12px">
        <div class="touch-row"><div></div><div id="up" class="touch-btn">↑</div><div></div></div>
        <div class="touch-row"><div id="left" class="touch-btn">←</div><div id="down" class="touch-btn">↓</div><div id="right" class="touch-btn">→</div></div>
      </div>
      <hr style="margin:12px 0;border:none;border-top:1px solid rgba(255,255,255,0.04)">
      <p>Keterangan singkat:</p>
      <ul style="color:var(--muted);font-size:13px">
        <li>Ular bertambah panjang tiap memakan makanan (buah).</li>
        <li>Bertabrakan dengan tubuh sendiri = game over.</li>
        <li>Mode tanpa tembok bisa diaktifkan dengan tombol <em>No Wall</em>.</li>
      </ul>
    </div> -->
  </div>

  <script>
    const canvas = document.getElementById('board');
    const ctx = canvas.getContext('2d');
    const scoreEl = document.getElementById('score');
    const restartBtn = document.getElementById('restart');
    const speedUp = document.getElementById('speedUp');
    const speedDown = document.getElementById('speedDown');
    const toggleWall = document.getElementById('toggleWall');

    const gridSize = 20;
    const cols = canvas.width / gridSize;
    const rows = canvas.height / gridSize;

    let snake, dir, nextDir, food, score, gameOver, interval, timerId;
    let noWall = true;

    function reset(){
      snake = [ {x:9,y:10}, {x:8,y:10}, {x:7,y:10} ];
      dir = {x:1,y:0};
      nextDir = dir;
      placeFood();
      score = 0;
      gameOver = false;
      scoreEl.textContent = score;
      interval = 120;
      startLoop();
    }

    function startLoop(){
      if(timerId) clearInterval(timerId);
      timerId = setInterval(tick, interval);
    }

    function tick(){
      dir = nextDir;
      const head = { x: snake[0].x + dir.x, y: snake[0].y + dir.y };

      if(noWall){
        if(head.x < 0) head.x = cols - 1;
        if(head.x >= cols) head.x = 0;
        if(head.y < 0) head.y = rows - 1;
        if(head.y >= rows) head.y = 0;
      } else {
        if(head.x < 0 || head.x >= cols || head.y < 0 || head.y >= rows){
          return endGame();
        }
      }

      for(let i=0;i<snake.length;i++){
        if(snake[i].x === head.x && snake[i].y === head.y){
          return endGame();
        }
      }

      snake.unshift(head);

      if(head.x === food.x && head.y === food.y){
        score += 10;
        scoreEl.textContent = score;
        placeFood();
      } else {
        snake.pop();
      }

      draw();
    }

    function placeFood(){
      while(true){
        const x = Math.floor(Math.random()*cols);
        const y = Math.floor(Math.random()*rows);
        let coll = false;
        for(const s of snake) if(s.x===x && s.y===y) { coll=true; break }
        if(!coll){ food={x,y}; break }
      }
    }

    function endGame(){
      gameOver = true;
      clearInterval(timerId);
      timerId = null;
      draw();
      ctx.fillStyle = 'rgba(0,0,0,0.6)';
      ctx.fillRect(0,0,canvas.width,canvas.height);
      ctx.fillStyle = '#fff';
      ctx.font = '20px sans-serif';
      ctx.textAlign = 'center';
      ctx.fillText('Game Over', canvas.width/2, canvas.height/2 - 10);
      ctx.font = '14px sans-serif';
      ctx.fillText('Score: ' + score, canvas.width/2, canvas.height/2 + 16);
    }

    function draw(){
      ctx.clearRect(0,0,canvas.width,canvas.height);
      ctx.strokeStyle = 'rgba(255,255,255,0.02)';
      for(let x=0;x<cols;x++){
        ctx.beginPath(); ctx.moveTo(x*gridSize,0); ctx.lineTo(x*gridSize,canvas.height); ctx.stroke();
      }
      for(let y=0;y<rows;y++){
        ctx.beginPath(); ctx.moveTo(0,y*gridSize); ctx.lineTo(canvas.width,y*gridSize); ctx.stroke();
      }

      ctx.fillStyle = '#ff4646';
      roundRect(ctx, food.x*gridSize+3, food.y*gridSize+3, gridSize-6, gridSize-6, 6);
      ctx.fill();

      for(let i=0;i<snake.length;i++){
        const s = snake[i];
        ctx.fillStyle = i===0 ? '#ffcc00' : `rgba(${60+i*3},${60+i*3},20,1)`;
        roundRect(ctx, s.x*gridSize+1, s.y*gridSize+1, gridSize-2, gridSize-2, 6);
        ctx.fill();
      }
    }

    function roundRect(ctx, x, y, w, h, r) {
      ctx.beginPath();
      ctx.moveTo(x + r, y);
      ctx.arcTo(x + w, y, x + w, y + h, r);
      ctx.arcTo(x + w, y + h, x, y + h, r);
      ctx.arcTo(x, y + h, x, y, r);
      ctx.arcTo(x, y, x + w, y, r);
      ctx.closePath();
    }

    window.addEventListener('keydown', e => {
      if(e.code === 'Space'){
        if(gameOver) reset(); else togglePause();
        e.preventDefault();
        return;
      }
      const map = {
        'ArrowUp': {x:0,y:-1},
        'ArrowDown': {x:0,y:1},
        'ArrowLeft': {x:-1,y:0},
        'ArrowRight': {x:1,y:0}
      };
      if(map[e.key] || map[e.code]){
        const d = map[e.key] || map[e.code];
        if(d.x === -dir.x && d.y === -dir.y) return;
        nextDir = d;
      }
    });

    function togglePause(){
      if(gameOver) return;
      if(timerId){ clearInterval(timerId); timerId=null; }
      else startLoop();
    }

    ['up','down','left','right'].forEach(id => {
      const el = document.getElementById(id);
      if(!el) return;
      el.addEventListener('touchstart', e => { e.preventDefault(); handleTouch(id); });
      el.addEventListener('mousedown', e => { e.preventDefault(); handleTouch(id); });
    });

    function handleTouch(id){
      const map = {
        up:{x:0,y:-1}, down:{x:0,y:1}, left:{x:-1,y:0}, right:{x:1,y:0}
      };
      const d = map[id];
      if(d.x === -dir.x && d.y === -dir.y) return;
      nextDir = d;
    }

    restartBtn.addEventListener('click', ()=> reset());
    speedUp.addEventListener('click', ()=> { interval = Math.max(40, interval - 10); startLoop(); });
    speedDown.addEventListener('click', ()=> { interval = Math.min(300, interval + 10); startLoop(); });

    toggleWall.addEventListener('click', ()=> {
      noWall = !noWall;
      toggleWall.textContent = `No Wall: ${noWall ? 'ON' : 'OFF'}`;
    });

    reset();
  </script>
</body>
</html>